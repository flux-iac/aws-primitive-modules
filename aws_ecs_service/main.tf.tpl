
######################################################################
# Generated by Tofu-Jet. Please do not manually edit.
# AWS Primitive Module for TF-controller
# Resource: aws_ecs_service
######################################################################

terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "4.33.0"
    }
  }
}

provider "aws" {
}

variable "values" {
  type = object({
    capacity_provider_strategy = optional(set(any))
    cluster = optional(string)
    deployment_circuit_breaker = optional(object({
        enable = optional(bool)
        rollback = optional(bool)
    }))
    deployment_controller = optional(object({
        type = optional(string)
    }))
    deployment_maximum_percent = optional(number)
    deployment_minimum_healthy_percent = optional(number)
    desired_count = optional(number)
    enable_ecs_managed_tags = optional(bool)
    enable_execute_command = optional(bool)
    force_new_deployment = optional(bool)
    health_check_grace_period_seconds = optional(number)
    iam_role = optional(string)
    launch_type = optional(string)
    load_balancer = optional(set(any))
    name = optional(string)
    network_configuration = optional(object({
        security_groups = optional(set(string))
        subnets = optional(set(string))
        assign_public_ip = optional(bool)
    }))
    ordered_placement_strategy = optional(object({
        type = optional(string)
        field = optional(string)
    }))
    placement_constraints = optional(set(any))
    propagate_tags = optional(string)
    scheduling_strategy = optional(string)
    service_registries = optional(object({
        container_name = optional(string)
        container_port = optional(number)
        port = optional(number)
        registry_arn = optional(string)
    }))
    tags = optional(map(string))
    task_definition = optional(string)
    wait_for_steady_state = optional(bool)
  })
}

resource "aws_ecs_service" "this" {
  capacity_provider_strategy = var.values.capacity_provider_strategy
  cluster = var.values.cluster
  deployment_circuit_breaker = var.values.deployment_circuit_breaker
  deployment_controller = var.values.deployment_controller
  deployment_maximum_percent = var.values.deployment_maximum_percent
  deployment_minimum_healthy_percent = var.values.deployment_minimum_healthy_percent
  desired_count = var.values.desired_count
  enable_ecs_managed_tags = var.values.enable_ecs_managed_tags
  enable_execute_command = var.values.enable_execute_command
  force_new_deployment = var.values.force_new_deployment
  health_check_grace_period_seconds = var.values.health_check_grace_period_seconds
  iam_role = var.values.iam_role
  launch_type = var.values.launch_type
  load_balancer = var.values.load_balancer
  name = var.values.name
  network_configuration = var.values.network_configuration
  ordered_placement_strategy = var.values.ordered_placement_strategy
  placement_constraints = var.values.placement_constraints
  propagate_tags = var.values.propagate_tags
  scheduling_strategy = var.values.scheduling_strategy
  service_registries = var.values.service_registries
  tags = var.values.tags
  task_definition = var.values.task_definition
  wait_for_steady_state = var.values.wait_for_steady_state
  {{- if $.Values.count }}
  count = {{ $.Values.count }}
  {{- end }}

  {{- if $.Values.lifecycle }}
  lifecycle {
    {{- if $.Values.lifecycle.create_before_destroy }}
    create_before_destroy = {{ $.Values.lifecycle.create_before_destroy }}
    {{- end }}
    {{- if $.Values.lifecycle.ignore_changes }}
    prevent_destroy = {{ $.Values.lifecycle.prevent_destroy }}
    {{- end }}
    {{- if $.Values.lifecycle.ignore_changes }}
    ignore_changes = {{ $.Values.lifecycle.ignore_changes }}
    {{- end }}
  }
  {{- end }}
}


output "cluster" {
    value = aws_ecs_service.this.cluster
}

output "iam_role" {
    value = aws_ecs_service.this.iam_role
}

output "launch_type" {
    value = aws_ecs_service.this.launch_type
}

output "platform_version" {
    value = aws_ecs_service.this.platform_version
}

